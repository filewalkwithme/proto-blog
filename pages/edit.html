<html>
  <head>
    <script src="assets/js/showdown.js"></script>
    <script src="assets/js/jquery-1.11.3.min.js"></script>
    <script src="assets/js/jquery-ui.js"></script>
    <script>
      var converter = new showdown.Converter();

      function update(){
        var srcText = $('#src').val();
        var html = converter.makeHtml(srcText);
        $("#target").html(html);
      }

      $(document).ready(function() {

        $("#src").on('input', function() {
          update()
        });

        $("#btnInsertList").on('click', function() {
            var caretPos = document.getElementById("src").selectionStart;
            var textAreaTxt = jQuery("#src").val();
            var txtToAdd = "\n\
* Red\n\
* Green\n\
* Blue\n\
";
            $("#src").val(textAreaTxt.substring(0, caretPos) + txtToAdd + textAreaTxt.substring(caretPos) );
            update();
        });

        update();

        $('#post-editor').dialog({
            autoOpen: true,
            width: 600,
            modal: false,
            appendTo: "#anchor",
            buttons: {
                "Ok": function () {
                    $(this).dialog("close");
                },
                "Cancel": function () {
                    $(this).dialog("close");
                }
            }
        });
      });

      function htmlUnescape(value){
          return String(value)
              .replace(/&quot;/g, '"')
              .replace(/&#39;/g, "'")
              .replace(/&#x2f;/g, "/")
              .replace(/&lt;/g, '<')
              .replace(/&gt;/g, '>')
              .replace(/&amp;/g, '&');
      }
    </script>
    <link rel="stylesheet" href="assets/css/custom-theme/jquery-ui-1.10.3.custom.css">
  </head>
  <body id="anchor">

      <div id="post-editor" title="Post editor" >
        <form method="POST" action="save">
          <input type="text" name="title" value="{{.Title}}" style="width:100%"/>
          <textarea name="content" id="src" style="height:90%;width:100%">{{.Content}}</textarea>
          <input type="hidden" name="id" value="{{.ID}}"/>
          <input type="submit" id="btnSave" value="Save"/>

        </form>
      </div>


      <div style="width: 100%;">
          <button id="btnInsertList">Insert List</button>
          <a href="/">Home</a>
          <div id="target" style="white-space: pre;">output</div>
      </div>

  </body>
</html>
