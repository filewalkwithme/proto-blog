<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="assets/images/favicon.ico">

    <title>Sticky Footer Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="assets/css/sticky-footer.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="assets/js/showdown.js"></script>
    <script src="assets/js/jquery-1.11.3.min.js"></script>
    <script src="assets/js/jquery-ui.js"></script>
    <script>
      var converter = new showdown.Converter();

      function update(){
        var srcText = $('#src').val();
        var html = converter.makeHtml(srcText);
        $("#target").html(html);
      }

      $(document).ready(function() {

        $("#src").on('input', function() {
          update()
        });

        function btnInsertList () {
            var caretPos = document.getElementById("src").selectionStart;
            var textAreaTxt = jQuery("#src").val();
            var txtToAdd = "\n\
* Red\n\
* Green\n\
* Blue\n\
";
            $("#src").val(textAreaTxt.substring(0, caretPos) + txtToAdd + textAreaTxt.substring(caretPos) );
            update();
        }

        update();

        $('#post-editor').dialog({
            autoOpen: true,
            width: 640,
            height: 480,
            modal: false,
            appendTo: "#anchor",
            buttons: {
                "Save": function () {
                  $("#form").submit();
                },
                "Insert List": function () {
                  btnInsertList();
                },
                "Ok": function () {
                    $(this).dialog("close");
                },
                "Back": function () {
                  window.location.replace("/");
                }
            }
        });
      });

      function htmlUnescape(value){
          return String(value)
              .replace(/&quot;/g, '"')
              .replace(/&#39;/g, "'")
              .replace(/&#x2f;/g, "/")
              .replace(/&lt;/g, '<')
              .replace(/&gt;/g, '>')
              .replace(/&amp;/g, '&');
      }
    </script>
    <link rel="stylesheet" href="assets/css/custom-theme/jquery-ui-1.10.3.custom.css">
  </head>

  <body id="anchor">
    <div id="post-editor" title="Post editor" >
      <div style="height:100%">
        <form id="form" method="POST" action="save" style="height:100%">
          <input type="text" name="title" value="{{.Title}}" style="width:100%"/>
          <textarea name="content" id="src" style="width:100%; height:90%">{{.Content}}</textarea>
          <input type="hidden" name="id" value="{{.ID}}"/>
        </form>
      </div>
    </div>

    <!-- Begin page content -->
    <div class="container">
      <div class="page-header">
        <h1>New Post</h1>
      </div>

      <div id="target" style="white-space: pre;">output</div>

      <hr/>
      <p>Posted at </p>
    </div>

    <footer class="footer">
      <div class="container">
        <p class="text-muted">Place sticky footer content here.</p>
      </div>
    </footer>


    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="assets/js/ie10-viewport-bug-workaround.js"></script>
  </body>
</html>
